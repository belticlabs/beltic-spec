{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schema.beltic.com/agent/v1/agent-credential-v1.schema.json",
  "title": "AgentCredential v1",
  "description": "Machine-readable schema for Beltic AgentCredential v1 (see docs/agent-credential-v1.md).",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schemaVersion",
    "agentId",
    "agentName",
    "agentVersion",
    "agentDescription",
    "firstReleaseDate",
    "currentStatus",
    "developerCredentialId",
    "developerCredentialVerified",
    "primaryModelProvider",
    "primaryModelFamily",
    "modelContextWindow",
    "modalitySupport",
    "languageCapabilities",
    "architectureType",
    "systemConfigFingerprint",
    "systemConfigLastUpdated",
    "deploymentEnvironment",
    "dataLocationProfile",
    "dataCategoriesProcessed",
    "dataRetentionMaxPeriod",
    "trainingDataUsage",
    "piiDetectionEnabled",
    "piiRedactionCapability",
    "dataEncryptionStandards",
    "harmfulContentRefusalScore",
    "harmfulContentBenchmarkName",
    "harmfulContentBenchmarkVersion",
    "harmfulContentEvaluationDate",
    "harmfulContentAssuranceSource",
    "promptInjectionRobustnessScore",
    "promptInjectionBenchmarkName",
    "promptInjectionBenchmarkVersion",
    "promptInjectionEvaluationDate",
    "promptInjectionAssuranceSource",
    "piiLeakageRobustnessScore",
    "piiLeakageBenchmarkName",
    "piiLeakageBenchmarkVersion",
    "piiLeakageEvaluationDate",
    "piiLeakageAssuranceSource",
    "incidentResponseContact",
    "incidentResponseSLO",
    "deprecationPolicy",
    "updateCadence",
    "humanOversightMode",
    "failSafeBehavior",
    "monitoringCoverage",
    "credentialIssuanceDate",
    "credentialExpirationDate",
    "overallSafetyRating",
    "ageRestrictions",
    "kybTierRequired",
    "verificationLevel",
    "credentialId",
    "issuerDid",
    "verificationMethod",
    "credentialStatus",
    "revocationListUrl",
    "proof"
  ],
  "$defs": {
    "uuid": {
      "type": "string",
      "format": "uuid"
    },
    "isoCountry": {
      "type": "string",
      "pattern": "^[A-Z]{2}$",
      "description": "ISO 3166-1 alpha-2 country code"
    },
    "isoLanguage": {
      "type": "string",
      "pattern": "^[a-z]{2}$",
      "description": "ISO 639-1 language code"
    },
    "isoDuration": {
      "type": "string",
      "pattern": "^P(?!$)(?:\\d+Y)?(?:\\d+M)?(?:\\d+W)?(?:\\d+D)?(?:T(?:\\d+H)?(?:\\d+M)?(?:\\d+S)?)?$",
      "description": "ISO 8601 duration"
    },
    "benchmarkName": {
      "type": "string",
      "maxLength": 200
    },
    "benchmarkVersion": {
      "type": "string",
      "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-[0-9A-Za-z.-]+)?$"
    },
    "assuranceSource": {
      "type": "string",
      "enum": ["self", "beltic", "third_party"]
    },
    "tool": {
      "type": "object",
      "required": [
        "toolId",
        "toolName",
        "toolDescription",
        "riskCategory",
        "riskSubcategory",
        "requiresAuth",
        "requiresHumanApproval"
      ],
      "additionalProperties": false,
      "properties": {
        "toolId": {
          "type": "string",
          "minLength": 1,
          "maxLength": 100
        },
        "toolName": {
          "type": "string",
          "minLength": 2,
          "maxLength": 200
        },
        "toolDescription": {
          "type": "string",
          "minLength": 10,
          "maxLength": 1000
        },
        "riskCategory": {
          "type": "string",
          "enum": ["data", "compute", "financial", "external"]
        },
        "riskSubcategory": {
          "type": "string",
          "enum": [
            "data_read_internal",
            "data_read_external",
            "data_write_internal",
            "data_write_external",
            "data_delete",
            "data_export",
            "compute_code_execution",
            "compute_query_generation",
            "compute_api_call",
            "compute_transformation",
            "compute_analysis",
            "financial_read",
            "financial_transaction",
            "financial_account_access",
            "financial_payment_initiation",
            "external_internet_access",
            "external_email",
            "external_notification",
            "external_authentication",
            "external_file_access"
          ]
        },
        "requiresAuth": { "type": "boolean" },
        "requiresHumanApproval": { "type": "boolean" },
        "mitigations": {
          "type": "string",
          "maxLength": 1000
        }
      }
    },
    "dataLocationProfile": {
      "type": "object",
      "required": ["storageRegions", "processingRegions"],
      "additionalProperties": false,
      "properties": {
        "storageRegions": {
          "type": "array",
          "items": { "$ref": "#/$defs/isoCountry" },
          "minItems": 1,
          "uniqueItems": true
        },
        "processingRegions": {
          "type": "array",
          "items": { "$ref": "#/$defs/isoCountry" },
          "minItems": 1,
          "uniqueItems": true
        },
        "backupRegions": {
          "type": "array",
          "items": { "$ref": "#/$defs/isoCountry" },
          "minItems": 1,
          "uniqueItems": true
        },
        "notes": {
          "type": "string",
          "maxLength": 500
        }
      }
    },
    "safetyScore": {
      "type": "number",
      "minimum": 0,
      "maximum": 100
    },
    "benchmarkMetadata": {
      "type": "object",
      "required": ["benchmarkName", "benchmarkVersion", "evaluationDate", "assuranceSource"],
      "additionalProperties": false,
      "properties": {
        "benchmarkName": { "$ref": "#/$defs/benchmarkName" },
        "benchmarkVersion": { "$ref": "#/$defs/benchmarkVersion" },
        "evaluationDate": { "type": "string", "format": "date" },
        "assuranceSource": { "$ref": "#/$defs/assuranceSource" }
      }
    }
  },
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema reference (optional)"
    },
    "schemaVersion": {
      "type": "string",
      "enum": ["1.0"]
    },
    "agentId": { "$ref": "#/$defs/uuid" },
    "agentName": {
      "type": "string",
      "minLength": 2,
      "maxLength": 200
    },
    "agentVersion": {
      "type": "string",
      "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-[0-9A-Za-z.-]+)?(?:\\+[0-9A-Za-z.-]+)?$"
    },
    "agentDescription": {
      "type": "string",
      "minLength": 50,
      "maxLength": 1000
    },
    "firstReleaseDate": { "type": "string", "format": "date" },
    "currentStatus": {
      "type": "string",
      "enum": ["production", "beta", "alpha", "internal", "deprecated", "retired"]
    },
    "developerCredentialId": { "$ref": "#/$defs/uuid" },
    "developerCredentialVerified": { "type": "boolean" },
    "primaryModelProvider": {
      "type": "string",
      "maxLength": 200
    },
    "primaryModelFamily": {
      "type": "string",
      "maxLength": 200
    },
    "modelContextWindow": {
      "type": "integer",
      "minimum": 1
    },
    "modalitySupport": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": ["text", "image", "audio", "video", "code", "structured_data"]
      },
      "minItems": 1,
      "uniqueItems": true
    },
    "languageCapabilities": {
      "type": "array",
      "items": { "$ref": "#/$defs/isoLanguage" },
      "minItems": 1,
      "uniqueItems": true
    },
    "architectureType": {
      "type": "string",
      "enum": [
        "single_agent",
        "rag",
        "tool_using",
        "multi_agent",
        "agentic_workflow",
        "fine_tuned",
        "hybrid"
      ]
    },
    "systemConfigFingerprint": {
      "type": "string",
      "pattern": "^[A-Fa-f0-9]{64}$"
    },
    "systemConfigLastUpdated": { "type": "string", "format": "date" },
    "deploymentEnvironment": {
      "type": "string",
      "maxLength": 500
    },
    "complianceCertifications": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": [
          "soc2_type1",
          "soc2_type2",
          "iso27001",
          "iso27017",
          "iso27018",
          "hipaa",
          "pci_dss",
          "fedramp",
          "gdpr_compliant",
          "ccpa_compliant"
        ]
      },
      "minItems": 1,
      "uniqueItems": true
    },
    "dataLocationProfile": { "$ref": "#/$defs/dataLocationProfile" },
    "toolsList": {
      "type": "array",
      "items": { "$ref": "#/$defs/tool" },
      "uniqueItems": true
    },
    "toolsLastAudited": { "type": "string", "format": "date" },
    "dataCategoriesProcessed": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": [
          "none",
          "pii",
          "phi",
          "financial",
          "biometric",
          "behavioral",
          "authentication",
          "proprietary",
          "government_id",
          "children_data"
        ]
      },
      "minItems": 1,
      "uniqueItems": true
    },
    "dataRetentionMaxPeriod": {
      "type": "string",
      "pattern": "^P(?!$).*"
    },
    "dataRetentionByCategory": {
      "type": "object",
      "additionalProperties": {
        "type": "string",
        "pattern": "^P(?!$).*"
      }
    },
    "trainingDataUsage": {
      "type": "string",
      "enum": [
        "never",
        "anonymized_only",
        "aggregated_only",
        "with_explicit_consent",
        "opt_out_available",
        "not_applicable"
      ]
    },
    "piiDetectionEnabled": { "type": "boolean" },
    "piiRedactionCapability": {
      "type": "string",
      "enum": ["none", "basic", "advanced", "context_aware"]
    },
    "piiRedactionPipeline": {
      "type": "string",
      "maxLength": 1000
    },
    "dataEncryptionStandards": {
      "type": "array",
      "items": { "type": "string", "maxLength": 200 },
      "minItems": 1,
      "uniqueItems": true
    },
    "harmfulContentRefusalScore": { "$ref": "#/$defs/safetyScore" },
    "harmfulContentBenchmarkName": { "$ref": "#/$defs/benchmarkName" },
    "harmfulContentBenchmarkVersion": { "$ref": "#/$defs/benchmarkVersion" },
    "harmfulContentEvaluationDate": { "type": "string", "format": "date" },
    "harmfulContentAssuranceSource": { "$ref": "#/$defs/assuranceSource" },
    "promptInjectionRobustnessScore": { "$ref": "#/$defs/safetyScore" },
    "promptInjectionBenchmarkName": { "$ref": "#/$defs/benchmarkName" },
    "promptInjectionBenchmarkVersion": { "$ref": "#/$defs/benchmarkVersion" },
    "promptInjectionEvaluationDate": { "type": "string", "format": "date" },
    "promptInjectionAssuranceSource": { "$ref": "#/$defs/assuranceSource" },
    "toolAbuseRobustnessScore": { "$ref": "#/$defs/safetyScore" },
    "toolAbuseBenchmarkName": { "$ref": "#/$defs/benchmarkName" },
    "toolAbuseBenchmarkVersion": { "$ref": "#/$defs/benchmarkVersion" },
    "toolAbuseEvaluationDate": { "type": "string", "format": "date" },
    "toolAbuseAssuranceSource": { "$ref": "#/$defs/assuranceSource" },
    "piiLeakageRobustnessScore": { "$ref": "#/$defs/safetyScore" },
    "piiLeakageBenchmarkName": { "$ref": "#/$defs/benchmarkName" },
    "piiLeakageBenchmarkVersion": { "$ref": "#/$defs/benchmarkVersion" },
    "piiLeakageEvaluationDate": { "type": "string", "format": "date" },
    "piiLeakageAssuranceSource": { "$ref": "#/$defs/assuranceSource" },
    "incidentResponseContact": {
      "type": "string",
      "format": "email",
      "maxLength": 254
    },
    "incidentResponseSLO": { "$ref": "#/$defs/isoDuration" },
    "deprecationPolicy": {
      "type": "string",
      "maxLength": 1000
    },
    "updateCadence": {
      "type": "string",
      "enum": [
        "continuous",
        "weekly",
        "biweekly",
        "monthly",
        "quarterly",
        "as_needed",
        "no_updates"
      ]
    },
    "humanOversightMode": {
      "type": "string",
      "enum": [
        "autonomous_low_risk",
        "human_review_pre_action",
        "human_review_post_action",
        "human_initiated_only",
        "custom_handover"
      ]
    },
    "failSafeBehavior": {
      "type": "string",
      "minLength": 50,
      "maxLength": 800
    },
    "monitoringCoverage": {
      "type": "string",
      "minLength": 50,
      "maxLength": 800
    },
    "credentialIssuanceDate": { "type": "string", "format": "date-time" },
    "credentialExpirationDate": { "type": "string", "format": "date-time" },
    "overallSafetyRating": {
      "type": "string",
      "enum": [
        "minimal_risk",
        "low_risk",
        "moderate_risk",
        "high_risk",
        "evaluation_pending"
      ]
    },
    "approvedUseCases": {
      "type": "array",
      "items": { "type": "string", "maxLength": 200 },
      "minItems": 1
    },
    "prohibitedUseCases": {
      "type": "array",
      "items": { "type": "string", "maxLength": 200 },
      "minItems": 1
    },
    "ageRestrictions": {
      "type": "string",
      "enum": ["none", "13+", "16+", "18+", "21+"]
    },
    "regulatoryApprovals": {
      "type": "array",
      "items": { "type": "string", "maxLength": 200 },
      "minItems": 1
    },
    "kybTierRequired": {
      "type": "string",
      "enum": ["tier_0", "tier_1", "tier_2", "tier_3", "tier_4"]
    },
    "verificationLevel": {
      "type": "string",
      "enum": ["self_attested", "beltic_verified", "third_party_verified"]
    },
    "lastSecurityAuditDate": { "type": "string", "format": "date" },
    "credentialId": { "$ref": "#/$defs/uuid" },
    "issuerDid": { "type": "string" },
    "verificationMethod": { "type": "string" },
    "credentialStatus": {
      "type": "string",
      "enum": ["active", "suspended", "revoked", "expired"]
    },
    "revocationListUrl": {
      "type": "string",
      "format": "uri"
    },
    "proof": {
      "type": "object",
      "required": ["type", "created", "verificationMethod", "proofPurpose", "proofValue"],
      "additionalProperties": false,
      "properties": {
        "type": { "type": "string" },
        "created": { "type": "string", "format": "date-time" },
        "verificationMethod": { "type": "string" },
        "proofPurpose": { "type": "string" },
        "proofValue": { "type": "string" }
      }
    }
  },
  "allOf": [
    {
      "if": {
        "properties": { "toolsList": { "type": "array", "minItems": 1 } },
        "required": ["toolsList"]
      },
      "then": {
        "required": [
          "toolAbuseRobustnessScore",
          "toolAbuseBenchmarkName",
          "toolAbuseBenchmarkVersion",
          "toolAbuseEvaluationDate",
          "toolAbuseAssuranceSource",
          "toolsLastAudited"
        ]
      },
      "else": {
        "properties": {
          "toolAbuseRobustnessScore": { "type": "number", "minimum": 0, "maximum": 100 },
          "toolAbuseBenchmarkName": { "$ref": "#/$defs/benchmarkName" },
          "toolAbuseBenchmarkVersion": { "$ref": "#/$defs/benchmarkVersion" },
          "toolAbuseEvaluationDate": { "type": "string", "format": "date" },
          "toolAbuseAssuranceSource": { "$ref": "#/$defs/assuranceSource" }
        }
      }
    }
  ]
}
